if(window.registerLoading){registerLoading("m/site-header")}(function(factory){if(typeof rrequire==="function"){rrequire(["jquery"],factory)}else{factory(jQuery,window)}}(function($,scope){var DEACTIVATE=function(el){el.classList.remove('active')};$.widget("cms.siteHeader",{options:{},_create:function(){Object.extend(this.options,this.element.data());this.els={nav:this.element[0]};this._getFixed();this.state={over:false,rtimer:0,stimer:0,htimer:0,h_height:0,wn_height:0,wn_width:0,scroll:0,collapsed:false};this.evt={focusin:function(e){var p,li=e.target.closest('li');if(!li||li.classList.contains('active')){return}else{this.els.nav.querySelectorAll("li.active").forEach(DEACTIVATE);li.classList.add('active');p=li.parentNode;while(p&&p!==this.els.nav){if(p.nodeName==='LI'){p.classList.add('active')}p=p.parentNode}}}.bind(this),navover:function(e){var a=e.target.closest("a");if(a){a.focus()}}.bind(this),navleave:function(e){var el;this.els.nav.querySelectorAll("li.active").forEach(DEACTIVATE);el=document.activeElement;if(el&&this.els.nav.contains(el)){el.blur()}}.bind(this),click:function(e){var el,data=e.target.linkData();if(data&&data.href&&data.href[0]==='#'&&(hash=data.href.substring(1))){el=document.querySelector("a[name='"+hash+"']");if(el){if($(this.els.header.children).filter('[role="dialog"]').data().cmsSimpleShowHide){$(this.els.header.children).filter('[role="dialog"]').data().cmsSimpleShowHide.hidePanel()}el.scrollIntoViewport({container:false,top:true,margin:200});e.preventDefault()}}}.bind(this),headerenter:function(){this.state.over=true}.bind(this),headerleave:function(){this.state.over=false;if(this.state.htimer){clearTimeout(this.state.htimer);this.state.htimer=setTimeout(this.evt.hide,4000)}}.bind(this),resize:function(){if(this.state.wn_width&&this.state.wn_width!==window.innerWidth){clearTimeout(this.state.rtimer);this.state.rtimer=setTimeout(this.evt.measure,250)}}.bind(this),measure:function(){this.measure()}.bind(this),scroll:function(){clearTimeout(this.state.stimer);clearTimeout(this.state.htimer);this.state.stimer=setTimeout(this.evt.adjust,100)}.bind(this),adjust:function(){this.adjust()}.bind(this),hide:function(){if(this.state.over){return}else{clearTimeout(this.state.htimer);this.state.htimer=0;this.adjust(true)}}.bind(this)};this.els.nav.addEventListener('focusin',this.evt.focusin);this.els.nav.addEventListener('mouseover',this.evt.navover);this.els.nav.addEventListener('mouseleave',this.evt.navleave);this.els.nav.addEventListener('click',this.evt.click);if(this.els.header){this.measure();this.adjust();this.els.header.addEventListener('mouseenter',this.evt.headerenter);this.els.header.addEventListener('mouseleave',this.evt.headerleave);window.addEventListener('resize',this.evt.resize);window.addEventListener('scroll',this.evt.scroll)}},_getFixed:function(){var style,position,p=this.els.nav.closest('[data-header]')||this.els.nav,get=window.getComputedStyle;while(p&&p!==document.body){style=get(p);position=style.getPropertyValue('position');if(position==='fixed'||position==='sticky'||position==='absolute'||p.matches("header")){this.els.header=p;this.els.type=position;break}p=p.parentNode}if(this.els.type==='fixed'||this.els.type==='absolute'){this.els.padding=document.querySelector("main>form:first-child>section")||document.querySelector("main>section:first-child")||document.querySelector("main")}},measure:function(){var dim;if(!this.els.header){return}dim=this.els.header.getBoundingClientRect();this.state.h_height=dim?dim.height:0;this.state.wn_height=window.innerHeight;this.state.wn_width=window.innerWidth;this.state.scroll=window.pageYOffset;if(this.els.padding){this.els.padding.style.paddingTop=this.state.h_height+'px'}},adjust:function(hide){var scroll,amount,collapse,html;if(!this.els.header){return}scroll=window.pageYOffset;amount=scroll-this.state.scroll;clearTimeout(this.state.htimer);if(scroll<this.state.h_height){collapse=false}else if(hide===true){collapse=true}else if(amount<this.state.wn_height/-3){collapse=false;this.state.htimer=setTimeout(this.evt.hide,4000)}else{collapse=true}this.state.scroll=scroll;html=document.documentElement;if(collapse){html.classList.remove('header-show');html.classList.add('header-hide')}else if(!scroll){html.classList.remove('header-hide');html.classList.remove('header-show')}else{html.classList.remove('header-hide');html.classList.add('header-show')}this.state.collapsed=collapse}});if(window.register){window.register("m/site-header")}}));